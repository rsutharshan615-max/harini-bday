/* Fonts: Playfair Display (titles), Poppins (body) */
:root {
  --bg: #0b0f1a;
  --fg: #e8ecf8;
  --muted: #a6b0c2;
  --primary: #6ac9ff;
  --accent: #ff7ad9;
  --glow: #6ac9ff55;
}
body[data-theme="elegant"] { --bg:#0e0e10; --fg:#f0f0f3; --muted:#b8b8c2; --primary:#c8a6ff; --accent:#ffd479; --glow:#c8a6ff55; }
body[data-theme="neon"] { --bg:#07090e; --fg:#e8f7ff; --muted:#8fb6ff; --primary:#70f0ff; --accent:#ff5bbd; --glow:#70f0ff55; }
body[data-theme="pastel"] { --bg:#10131a; --fg:#fbfbfe; --muted:#b5c0d0; --primary:#ffd4e5; --accent:#b9f3ff; --glow:#ffd4e555; }

* { box-sizing: border-box; }
html, body { height: 100%; }
body {
  margin: 0;
  background: radial-gradient(1200px 800px at 70% 20%, #0f1730, var(--bg));
  color: var(--fg);
  font-family: 'Poppins', system-ui, -apple-system, Segoe UI, Roboto, Ubuntu, Cantarell, 'Helvetica Neue', Arial, sans-serif;
  overflow-x: hidden;
}
.hidden { display: none; }

/* Preloader */
#preloader { position: fixed; inset: 0; background: var(--bg); display: grid; place-items: center; gap: 16px; z-index: 1000; }
#preloader .spinner { width: 48px; height: 48px; border-radius: 999px; border: 4px solid #1f2942; border-top-color: var(--primary); animation: spin 1s linear infinite; }
#preloader p { color: var(--muted); letter-spacing: .12em; text-transform: uppercase; font-size: 12px; }
@keyframes spin { to { transform: rotate(360deg) } }

/* Canvas fills page */
#scene { position: fixed; inset: 0; z-index: 0; display: block; }

/* Sections */
main { position: relative; z-index: 1; }
section { position: relative; padding: 96px 24px; }

/* Hero */
.hero { min-height: 100dvh; display: grid; place-items: center; text-align: center; }
.hero .glow { position: absolute; inset: -10%; background: radial-gradient(600px 600px at 50% 50%, var(--glow), transparent 60%); filter: blur(40px); opacity: .8; pointer-events: none; }
.title { font-family: 'Playfair Display', serif; font-weight: 800; font-size: clamp(44px, 7vw, 96px); line-height: 1.05; letter-spacing: -0.02em; margin: 0 0 12px; }
.title .small { font-family: 'Poppins', sans-serif; display: block; font-weight: 300; font-size: clamp(16px, 2.4vw, 22px); color: var(--muted); letter-spacing: .18em; text-transform: uppercase; }
.title #friendName { background: linear-gradient(90deg, #88e0ff, #ff9bd6 50%, #ffd479); -webkit-background-clip: text; background-clip: text; color: transparent; }
.subtitle { color: var(--muted); font-size: clamp(14px, 2.2vw, 18px); margin: 4px 0 24px; }
.countdown { font-variant-numeric: tabular-nums; color: var(--primary); opacity:.9; margin: 6px 0 16px; letter-spacing:.08em; }
.actions { display: flex; gap: 14px; justify-content: center; }
.btn { appearance: none; border: 1px solid #2a3556; color: var(--fg); background: #11182c; padding: 12px 18px; border-radius: 12px; font-weight: 600; letter-spacing: .02em; cursor: pointer; transition: transform .15s ease, box-shadow .2s ease, border-color .2s ease; }
.btn:hover { transform: translateY(-1px); border-color: #3a4a78; box-shadow: 0 8px 24px #00000055; }
.btn.primary { background: linear-gradient(90deg, #1a2342, #121a31); border-color: #345; }
.btn.ghost { background: transparent; }
.btn.fire { background: linear-gradient(90deg, #ff8a5b, #ff5bbd); border: none; box-shadow: 0 12px 32px #ff5bbd33; }
.scroll { position: absolute; bottom: 28px; left: 50%; transform: translateX(-50%); display: grid; place-items: center; gap: 8px; opacity: .7; }
.scroll span { font-size: 12px; color: var(--muted); letter-spacing: .18em; text-transform: uppercase; }
.mouse { width: 24px; height: 36px; border: 2px solid #3c4770; border-radius: 16px; position: relative; }
.wheel { width: 3px; height: 8px; border-radius: 6px; background: #5a6aa0; position: absolute; top: 6px; left: 50%; transform: translateX(-50%); animation: wheel 1.6s ease-in-out infinite; }
@keyframes wheel { 0% { opacity: 0; transform: translate(-50%, 0) } 40% { opacity: 1 } 100% { opacity: 0; transform: translate(-50%, 12px) } }

/* Cinematic text */
.cinematic { min-height: 80dvh; display: grid; place-items: center; }
.cinematic .panel { max-width: 900px; text-align: center; }
.line { font-family: 'Playfair Display', serif; font-size: clamp(22px, 3.4vw, 40px); line-height: 1.25; margin: 18px 0; opacity: .08; transform: translateY(20px); transition: opacity .6s ease, transform .6s ease; }
.line.active { opacity: 1; transform: translateY(0); }

/* Slideshow */
.slideshow { padding-top: 40px; }
.slideshow-frame { position: relative; width: min(1000px, 92vw); height: clamp(220px, 55vw, 520px); margin: 0 auto; border-radius: 16px; overflow: hidden; border:1px solid #2a3556; box-shadow: 0 12px 40px #0008; background:#0c1224; display:grid; place-items:center; }
#slideImg { width: 100%; height: 100%; object-fit: cover; transform-origin: center; will-change: transform, opacity; }
.slideshow .controls { position: absolute; bottom: 12px; left: 50%; transform: translateX(-50%); display:flex; gap:10px; }

/* Inline Story (IG-like) */
.story-inline { position: absolute; inset: 0; display:grid; place-items:center; padding: 24px; }
.story-inline .segments { position:absolute; top:12px; left:12px; right:12px; display:flex; gap:6px; }
.story-inline .segments span { flex:1; height:3px; background:#233056; border-radius:999px; overflow:hidden; }
.story-inline .segments span i { display:block; height:100%; width:0%; background:linear-gradient(90deg,var(--primary),var(--accent)); }
.story-inline .circle { width: min(60vmin, 300px); height: min(60vmin, 300px); border-radius:50%; border:4px solid #31406a; box-shadow: 0 10px 40px #0008, inset 0 0 12px #0006; overflow:hidden; display:grid; place-items:center; background:#0f1730; }
.story-inline .circle img { width:100%; height:100%; object-fit: cover; }
.story-inline .caption { margin-top: 12px; color:#dbe7ff; text-align:center; font-weight:600; text-shadow:0 6px 20px #000; }
.story-inline .tap { position:absolute; inset:0; }

/* Gallery */
.section-title { text-align: center; font-family: 'Playfair Display', serif; font-size: clamp(28px, 5vw, 56px); margin: 0 0 28px; }
.uploader { display: grid; place-items: center; gap: 8px; margin: 0 auto 18px; text-align: center; }
.uploader .hint { color: var(--muted); font-size: 12px; }
.grid { display: grid; grid-template-columns: repeat(2, 1fr); gap: 12px; max-width: 1100px; margin: 0 auto; }
@media (min-width: 840px) { .grid { grid-template-columns: repeat(4, 1fr); gap: 16px; } }
.card { position: relative; perspective: 1000px; }
.card .inner { position: relative; border-radius: 14px; overflow: hidden; border: 1px solid #2a3556; background:#0f1730; box-shadow: 0 10px 30px #00000033; transform-style: preserve-3d; aspect-ratio: 3/4; }
/* Rotate faces instead of container for maximum compatibility */
.card .face { position: absolute; inset: 0; backface-visibility: hidden; -webkit-backface-visibility: hidden; transition: transform .6s cubic-bezier(.2,.8,.2,1); }
.card .front { transform: rotateY(0deg); z-index: 2; }
.card .front img { width: 100%; height: 100%; display:block; object-fit: cover; filter: saturate(1.08) contrast(1.05); backface-visibility: hidden; -webkit-backface-visibility: hidden; }
.card .back { position: absolute; inset: 0; display: grid; grid-template-rows: auto 1fr auto; gap: 10px; padding: 18px; transform: rotateY(-180deg); background: linear-gradient(180deg, #0b0f1a, #0a122a); z-index: 1; }
/* Hover flip for desktop */
.card:hover .front { transform: rotateY(180deg); }
.card:hover .back  { transform: rotateY(0deg); }
/* Tap/click flip for mobile or explicit toggles */
.card.flipped .front { transform: rotateY(180deg); }
.card.flipped .back  { transform: rotateY(0deg); }
.card .back .title { font-weight: 700; letter-spacing: .3px; color: #e8ecf8; }
.card .quote { color: #d6defa; font-size: clamp(12px, 1.6vw, 16px); line-height: 1.7; text-align: left; white-space: pre-line; overflow: auto; padding-right: 6px; }
.card .hint { color: #9fb0de; font-size: 12px; opacity: .8; text-align: center; }
/* Nice scrollbar on back */
.card .quote::-webkit-scrollbar { width: 6px; }
.card .quote::-webkit-scrollbar-thumb { background: #2a3556; border-radius: 999px; }
.gallery.dragging { outline: 2px dashed #3a4a78; outline-offset: 10px; border-radius: 16px; }

/* Fireworks (hidden; ambient fireworks run everywhere) */
.fireworks { display: none !important; }
#fireworksCanvas { display: none !important; }

/* Wish Wall */
.wish-form { display:flex; gap:8px; justify-content:center; margin-bottom: 14px; }
.wish-form input { background:#0f1730; border:1px solid #2a3556; border-radius:10px; color:var(--fg); padding:10px 12px; min-width: 180px; }
.wish-list { list-style:none; padding:0; margin:0 auto; max-width: 900px; display:grid; gap:8px; }
.wish-list li { background:#0f1730; border:1px solid #2a3556; border-radius:12px; padding:12px 14px; display:flex; align-items:center; justify-content:space-between; }
.wish-meta { color:var(--muted); font-size:12px; }
.wish-text { margin: 2px 0 0; }
.wish { display:flex; flex-direction:column; }
.wish-actions button { background:transparent; border:1px solid #344269; color:#dbe7ff; padding:6px 10px; border-radius:8px; cursor:pointer; }

/* Final */
.final { min-height: 70dvh; display: grid; place-items: center; text-align: center; gap: 18px; }
.big-wish { font-family: 'Playfair Display', serif; font-size: clamp(36px, 7vw, 90px); margin: 0; background: linear-gradient(90deg, #88e0ff, #ff9bd6 50%, #ffd479); -webkit-background-clip: text; background-clip: text; color: transparent; filter: drop-shadow(0 12px 28px #0006); }
.share { margin-top: 6px; }

/* Lightbox */
.lightbox { position: fixed; inset: 0; background: #050813cc; backdrop-filter: blur(6px); display: grid; place-items: center; z-index: 50; }
.lightbox.hidden { display: none; }
.lightbox img { max-width: 92vw; max-height: 84vh; border-radius: 16px; border: 1px solid #2a3556; box-shadow: 0 12px 50px #00000088; }
.lightbox .close { position: absolute; top: 18px; right: 18px; font-size: 28px; width: 40px; height: 40px; border-radius: 10px; border: 1px solid #344269; background: #0f1730; color: #dbe7ff; cursor: pointer; }

/* Story Reel Overlay */
.reel { position: fixed; inset: 0; z-index: 60; background: radial-gradient(1200px 800px at 50% 20%, #0e1530, #070b1a 60%, #050914); overflow: hidden; display: grid; place-items: center; }
.reel img { position: absolute; inset: 0; width: 100%; height: 100%; object-fit: cover; filter: saturate(1.05) contrast(1.06); }
.reel .vignette { position: absolute; inset: 0; background: radial-gradient(70% 60% at 50% 50%, transparent, rgba(0,0,0,.45)); pointer-events: none; }
.reel .caption { position: absolute; bottom: 12%; left: 50%; transform: translateX(-50%); max-width: min(90vw, 860px); text-align: center; font-family: 'Playfair Display', serif; font-size: clamp(18px, 3.2vw, 38px); color: #e8ecf8; text-shadow: 0 6px 24px #000; padding: 10px 16px; border-radius: 14px; background: linear-gradient(180deg, #0b0f1a66, #0b0f1ab0); border: 1px solid #2a3556; }
.reel .topbar { position: absolute; top: 14px; left: 14px; right: 14px; display: flex; align-items: center; gap: 8px; }
.reel .progress { flex: 1; height: 4px; background: #2a3556; border-radius: 999px; overflow: hidden; }
.reel .progress > div { height: 100%; width: 0%; background: linear-gradient(90deg, var(--primary), var(--accent)); }
.reel .close { position: absolute; top: 14px; right: 14px; background: #0f1730; color: #dbe7ff; border:1px solid #344269; border-radius:10px; padding:8px 12px; cursor:pointer; }

/* Footer */
.footer { padding: 36px 16px 80px; text-align: center; color: var(--muted); font-size: 12px; display:grid; gap:10px; place-items:center; }
.footer .theme { display:flex; align-items:center; gap:8px; }
